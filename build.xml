<project name="Intcode VM" default="all">

<property file="build.properties"/>

<pathconvert property="src.files" pathsep=" ">
    <path>
        <fileset dir="src">
            <include name="**/*.d"/>
        </fileset>
    </path>
</pathconvert>

<target name="clean">
    <delete file="${exe.name}" failonerror="false"/>
    <delete dir="${obj.dir}" failonerror="false"/>
</target>

<target name="compile">
    <exec executable="ldc2" failonerror="true">
        <arg line="--betterC"/>
        <arg line="-g --fsanitize=address"/>
        <arg line="--od=${obj.dir}"/>
        <arg line="--of=${exe.name}"/>
        <arg line="${src.files}"/>
    </exec>
</target>

<target name="release">
    <exec executable="ldc2" failonerror="true">
        <arg line="--betterC"/>
        <arg line="--release"/>
        <arg line="--od=${obj.dir}"/>
        <arg line="--of=${exe.name}"/>
        <arg line="${src.files}"/>
    </exec>
</target>

<target name="all" depends="clean,compile">
</target>

</project>